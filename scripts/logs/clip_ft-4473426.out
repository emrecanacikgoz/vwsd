=======================
Loading Anaconda Module...
"data":    {'debug': True, 'batch_size': 4, 'num_workers': 5, 'train_dir': '/datasets/SemEval/semeval-2023-task-1-V-WSD-train-v1/train_v1', 'trial_dir': '/datasets/SemEval/semeval-2023-task-1-V-WSD-train-v1/trial_v1'}
"model":   {'name': 'CLIPFinetune'}
"output":  clip_ft.out
"seed":    12345
"trainer": {'accelerator': 'gpu', 'devices': 1, 'max_epochs': 15, 'precision': 16, 'gradient_clip_val': 1.0, 'val_check_interval': 1.0, 'resume_from_checkpoint': None, 'accumulate_grad_batches': 1, 'num_sanity_val_steps': 0}
/scratch/users/oince22/vwsd/scripts
self.debug: True
Config: "data":    {'debug': True, 'batch_size': 4, 'num_workers': 5, 'train_dir': '/datasets/SemEval/semeval-2023-task-1-V-WSD-train-v1/train_v1', 'trial_dir': '/datasets/SemEval/semeval-2023-task-1-V-WSD-train-v1/trial_v1'}
"model":   {'name': 'CLIPFinetune'}
"output":  /scratch/users/oince22/vwsd/scripts/clip_ft.out
"seed":    12345
"trainer": {'accelerator': 'gpu', 'devices': 1, 'max_epochs': 15, 'precision': 16, 'gradient_clip_val': 1.0, 'val_check_interval': 1.0, 'resume_from_checkpoint': None, 'accumulate_grad_batches': 1, 'num_sanity_val_steps': 0}
/scratch/users/oince22/vwsd/scripts
self.debug: True
Training: 0it [00:00, ?it/s]Training:   0%|          | 0/10 [00:00<?, ?it/s]Epoch 0:   0%|          | 0/10 [00:00<?, ?it/s] /kuacc/users/oince22/.conda/envs/vwsd/lib/python3.10/site-packages/PIL/Image.py:3035: DecompressionBombWarning: Image size (89550550 pixels) exceeds limit of 89478485 pixels, could be decompression bomb DOS attack.
  warnings.warn(
B, N, C, H, W: (4, 10, 3, 224, 224)
output.shape: torch.Size([4, 10]), labels.shape:torch.Size([1, 4])
output.shape: torch.Size([4, 10]), labels.shape:torch.Size([4])
Epoch 0:  10%|â–ˆ         | 1/10 [00:08<01:14,  8.25s/it]Epoch 0:  10%|â–ˆ         | 1/10 [00:08<01:14,  8.25s/it, loss=0.617]B, N, C, H, W: (4, 10, 3, 224, 224)
output.shape: torch.Size([4, 10]), labels.shape:torch.Size([1, 4])
output.shape: torch.Size([4, 10]), labels.shape:torch.Size([4])
Epoch 0:  20%|â–ˆâ–ˆ        | 2/10 [00:08<00:35,  4.44s/it, loss=0.617]Epoch 0:  20%|â–ˆâ–ˆ        | 2/10 [00:08<00:35,  4.44s/it, loss=0.679]B, N, C, H, W: (4, 10, 3, 224, 224)
output.shape: torch.Size([4, 10]), labels.shape:torch.Size([1, 4])
output.shape: torch.Size([4, 10]), labels.shape:torch.Size([4])
Epoch 0:  30%|â–ˆâ–ˆâ–ˆ       | 3/10 [00:09<00:22,  3.16s/it, loss=0.679]Epoch 0:  30%|â–ˆâ–ˆâ–ˆ       | 3/10 [00:09<00:22,  3.16s/it, loss=0.882]B, N, C, H, W: (4, 10, 3, 224, 224)
output.shape: torch.Size([4, 10]), labels.shape:torch.Size([1, 4])
output.shape: torch.Size([4, 10]), labels.shape:torch.Size([4])
Epoch 0:  40%|â–ˆâ–ˆâ–ˆâ–ˆ      | 4/10 [00:10<00:15,  2.53s/it, loss=0.882]Epoch 0:  40%|â–ˆâ–ˆâ–ˆâ–ˆ      | 4/10 [00:10<00:15,  2.53s/it, loss=0.71] B, N, C, H, W: (4, 10, 3, 224, 224)
output.shape: torch.Size([4, 10]), labels.shape:torch.Size([1, 4])
output.shape: torch.Size([4, 10]), labels.shape:torch.Size([4])
Epoch 0:  50%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆ     | 5/10 [00:10<00:10,  2.16s/it, loss=0.71]Epoch 0:  50%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆ     | 5/10 [00:10<00:10,  2.16s/it, loss=0.606]B, N, C, H, W: (4, 10, 3, 224, 224)
output.shape: torch.Size([4, 10]), labels.shape:torch.Size([1, 4])
output.shape: torch.Size([4, 10]), labels.shape:torch.Size([4])
Epoch 0:  60%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ    | 6/10 [00:11<00:07,  1.90s/it, loss=0.606]Epoch 0:  60%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ    | 6/10 [00:11<00:07,  1.90s/it, loss=0.611]B, N, C, H, W: (4, 10, 3, 224, 224)
output.shape: torch.Size([4, 10]), labels.shape:torch.Size([1, 4])
output.shape: torch.Size([4, 10]), labels.shape:torch.Size([4])
Epoch 0:  70%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ   | 7/10 [00:12<00:05,  1.72s/it, loss=0.611]Epoch 0:  70%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ   | 7/10 [00:12<00:05,  1.72s/it, loss=0.716]B, N, C, H, W: (4, 10, 3, 224, 224)
output.shape: torch.Size([4, 10]), labels.shape:torch.Size([1, 4])
output.shape: torch.Size([4, 10]), labels.shape:torch.Size([4])
Epoch 0:  80%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ  | 8/10 [00:12<00:03,  1.59s/it, loss=0.716]Epoch 0:  80%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ  | 8/10 [00:12<00:03,  1.59s/it, loss=0.965]B, N, C, H, W: (4, 10, 3, 224, 224)
output.shape: torch.Size([4, 10]), labels.shape:torch.Size([1, 4])
output.shape: torch.Size([4, 10]), labels.shape:torch.Size([4])
Epoch 0:  90%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ | 9/10 [00:13<00:01,  1.48s/it, loss=0.965]Epoch 0:  90%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ | 9/10 [00:13<00:01,  1.48s/it, loss=0.86] 
Validation: 0it [00:00, ?it/s][A
Validation:   0%|          | 0/1 [00:00<?, ?it/s][A
Validation DataLoader 0:   0%|          | 0/1 [00:00<?, ?it/s][AB, N, C, H, W: (4, 10, 3, 224, 224)
output.shape: torch.Size([4, 10]), labels.shape:torch.Size([1, 4])
output.shape: torch.Size([4, 10]), labels.shape:torch.Size([4])
Error executing job with overrides: []
Traceback (most recent call last):
  File "/scratch/users/oince22/vwsd/scripts/clip_ft_pred.py", line 39, in main
    results = trainer.fit(experiment, datamodule=train_dm)
  File "/kuacc/users/oince22/.conda/envs/vwsd/lib/python3.10/site-packages/pytorch_lightning/trainer/trainer.py", line 582, in fit
    call._call_and_handle_interrupt(
  File "/kuacc/users/oince22/.conda/envs/vwsd/lib/python3.10/site-packages/pytorch_lightning/trainer/call.py", line 38, in _call_and_handle_interrupt
    return trainer_fn(*args, **kwargs)
  File "/kuacc/users/oince22/.conda/envs/vwsd/lib/python3.10/site-packages/pytorch_lightning/trainer/trainer.py", line 624, in _fit_impl
    self._run(model, ckpt_path=self.ckpt_path)
  File "/kuacc/users/oince22/.conda/envs/vwsd/lib/python3.10/site-packages/pytorch_lightning/trainer/trainer.py", line 1061, in _run
    results = self._run_stage()
  File "/kuacc/users/oince22/.conda/envs/vwsd/lib/python3.10/site-packages/pytorch_lightning/trainer/trainer.py", line 1140, in _run_stage
    self._run_train()
  File "/kuacc/users/oince22/.conda/envs/vwsd/lib/python3.10/site-packages/pytorch_lightning/trainer/trainer.py", line 1163, in _run_train
    self.fit_loop.run()
  File "/kuacc/users/oince22/.conda/envs/vwsd/lib/python3.10/site-packages/pytorch_lightning/loops/loop.py", line 199, in run
    self.advance(*args, **kwargs)
  File "/kuacc/users/oince22/.conda/envs/vwsd/lib/python3.10/site-packages/pytorch_lightning/loops/fit_loop.py", line 267, in advance
    self._outputs = self.epoch_loop.run(self._data_fetcher)
  File "/kuacc/users/oince22/.conda/envs/vwsd/lib/python3.10/site-packages/pytorch_lightning/loops/loop.py", line 200, in run
    self.on_advance_end()
  File "/kuacc/users/oince22/.conda/envs/vwsd/lib/python3.10/site-packages/pytorch_lightning/loops/epoch/training_epoch_loop.py", line 251, in on_advance_end
    self._run_validation()
  File "/kuacc/users/oince22/.conda/envs/vwsd/lib/python3.10/site-packages/pytorch_lightning/loops/epoch/training_epoch_loop.py", line 310, in _run_validation
    self.val_loop.run()
  File "/kuacc/users/oince22/.conda/envs/vwsd/lib/python3.10/site-packages/pytorch_lightning/loops/loop.py", line 199, in run
    self.advance(*args, **kwargs)
  File "/kuacc/users/oince22/.conda/envs/vwsd/lib/python3.10/site-packages/pytorch_lightning/loops/dataloader/evaluation_loop.py", line 152, in advance
    dl_outputs = self.epoch_loop.run(self._data_fetcher, dl_max_batches, kwargs)
  File "/kuacc/users/oince22/.conda/envs/vwsd/lib/python3.10/site-packages/pytorch_lightning/loops/loop.py", line 199, in run
    self.advance(*args, **kwargs)
  File "/kuacc/users/oince22/.conda/envs/vwsd/lib/python3.10/site-packages/pytorch_lightning/loops/epoch/evaluation_epoch_loop.py", line 137, in advance
    output = self._evaluation_step(**kwargs)
  File "/kuacc/users/oince22/.conda/envs/vwsd/lib/python3.10/site-packages/pytorch_lightning/loops/epoch/evaluation_epoch_loop.py", line 234, in _evaluation_step
    output = self.trainer._call_strategy_hook(hook_name, *kwargs.values())
  File "/kuacc/users/oince22/.conda/envs/vwsd/lib/python3.10/site-packages/pytorch_lightning/trainer/trainer.py", line 1443, in _call_strategy_hook
    output = fn(*args, **kwargs)
  File "/kuacc/users/oince22/.conda/envs/vwsd/lib/python3.10/site-packages/pytorch_lightning/strategies/strategy.py", line 390, in validation_step
    return self.model.validation_step(*args, **kwargs)
  File "/kuacc/users/oince22/.conda/envs/vwsd/lib/python3.10/site-packages/torch/autograd/grad_mode.py", line 27, in decorate_context
    return func(*args, **kwargs)
  File "/kuacc/users/oince22/.conda/envs/vwsd/lib/python3.10/site-packages/vwsd-0.0.1-py3.10.egg/vwsd/experiment.py", line 44, in validation_step
    loss = F.cross_entropy(prob, labels)
NameError: name 'prob' is not defined

Set the environment variable HYDRA_FULL_ERROR=1 for a complete stack trace.
Epoch 0:  90%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ | 9/10 [00:26<00:02,  2.99s/it, loss=0.86]

                                                              [A